<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Resumator</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <script type="text/javascript" src="/js/libs/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="/js/libs/underscore-min.js"></script>
    <script type="text/javascript" src="/js/libs/backbone-min.js"></script>
  </head>

  <% if @user %>
  <body data-id="<%= @user.id %>">
  <% else %>
  <body>
  <% end %>

    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner ">
        <div class="container">
          <ul class="nav ">
            <li><a href="/">home</a></li>
            <li class="divider-vertical"></li>
            <% if current_user %>
              <li><a href="/sign_out/">sign out</a></li>
              <li class="divider-vertical"></li>
              <li><a href="/<%= @current_user.nickname %>">Hello <%= @current_user.nickname %></a></li>
              <li class="divider-vertical"></li>
            <% else %>
              <li><a href="/sign_in/">sign in</a></li>
              <li class="divider-vertical"></li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>

    <%= yield %>

  </body>

  <!-- User list template -->
  <script type="text/template" id="users_template">
    <h1>People</h1>
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Nickname</th>
          <th>Go To Profile</th>
        </tr>
      </thead>
      <tbody>
        [% _.each(users, function(user) { %]
          <tr>
            <td>[%= user.get('id') %]</td>
            <td>[%= user.get('name') %]</td>
            <td>[%= user.get('nickname') %]</td>
            <td><a class="" href="/[%= user.get('nickname') %]">View Profile</a></td>
          </tr>
        [% }); %]
      </tbody>
    </table>
  </script>

  <!-- Single User Template -->
  <script type="text/template" id="user_view">
    <a href="#" class="btn edit-btn" data-mode="false">Edit</a>
    <h1>[%= name %]</h1>
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>ID</th>
          <th>Nickname</th>
          <th>Bio</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>[%= user.get('id') %]</td>
          <td>[%= user.get('nickname') %]</td>
          <td></td>
        </tr>
      </tbody>
    </table>
    <h2>Links</h2>
    <ol>
        [% _.each(user.links, function(link) { %]
          <li>
          <a href="[%= link.get('url') %]">[%= link.get('name') %]</a>
          </li>
        [% }); %]
  </script>

  <!-- Edit User Template -->
  <script type="text/template" id="user_edit">
    <div class="well">
      <h3>Edit User</h3>
      <form>
        <a href="#" class="btn save-btn">Save</a>
        <fieldset>
          <label>Name</label>
          <input type="text" 
                 placeholder="Name" 
                 value="[%= user.get('id') %]">
          <label>Bio</label>
          <textarea rows="6" 
                    placeholder="About you"
                    value="[%= user.get('bio') %]"></textarea>
          <br/>
        </fieldset>
        <a href="#" class="btn save-btn">Save</a>
      </form>
    <h2>Links</h2>
    <form id="add_link">
        <input type="text" placeholder="URL" name="url"/>
        <input type="text" placeholder="Name" name="name"/>
        <a href="#" class="btn add-btn">Add</a>
    </form>
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>Name</th>
          <th>URL</th>
        </tr>
      </thead>
      <tbody id="link_list">
        [% _.each(user.links, function(link) { %]
            [% _.template($('link_view').html())({name: link.get('name'),
                                                  url: link.get('url')}) %]
        [% }); %]
      </tbody>
  </table>
    </div>
  </script>

  <!-- View Link Template -->
  <script type="text/template" id="link_view">
      <tr>
        <td>[%= name %]</td>
        <td>[%= url %]</td>
      </tr>
  </script>

  <!-- The Application -->
  <script type="text/javascript" src="/js/application.js"></script>
</html> 
